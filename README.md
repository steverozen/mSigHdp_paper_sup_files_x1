This repository contains supplementary files - synthetic data, code, and analytical results - 
for the paper

> Mo Liu, Yang Wu, Nanhai Jiang, Arnoud Boot, Steven G. Rozen,
> ***mSigHdp: hierarchical Dirichlet process mixture modeling for mutational signature discovery***, 


See https://github.com/steverozen/mSigHdp and https://github.com/steverozen/hdpx for mSigHdp.

### Structure

The files are organized as follows.

#### Data set directories at the top-level:
- `SBS_set1` and `SBS_set2`: SBS (single-base substitution) synthetic input
data, SBS-specific code, and SBS results. "set2" is more complex compared to 
"set1", with:
  * more mutational signatures operative in the data set
  * more cancer types
  * a higher number of synthetic mutational spectra in total
- `SBS_set1_down_samp` and `SBS_set2_down_samp`: folder to store results of
  mSigHdp running on SBS_set1 or SBS_set2, with functionality to down-sample
  counts of synthetic mutational spectra enabled. In second-level folder 
  "raw_results", the naming of third-level folders
  * mSigHdp_ds_1k.results
  * mSigHdp_ds_3k.results
  * mSigHdp_ds_5k.results
  * mSigHdp_ds_10k.results
  implies the threshold for down-sampling (1000, 3000, 5000, 10000 respectively).
  These thresholds are passed to argument `downsample_threshold` in function 
  `mSigHdp::RunHdpxParallel()`, and all mutational spectra whose mutation counts
  lower than the threshold will NOT be down-sampled. For more details, please
  view the documentation of `mSigHdp::RunHdpxParallel()`.
- sens_SBS35_<NN>_728:

- sens_SBS35_<NN>_1066:

- `indel_set1` and `indel_set2`: Indel (small insertion and deletion) synthetic
input data, indel-specific code, and indel results. Same as the SBS data sets,
"set2" is more complex compared to "set1".
- 

#### Other top-level directories:
- `common_code`: Code used for both SBS and indel analysis
- `output_for_paper`: Main text figures/tables and supplementary figures/tables.
They are generated by running scripts in `common_code`.


The directories for all data sets have the same structure, as follows:
  - `code` contains script files specific to synthetic data generation and 
    running of signature extraction approaches. These scripts should be run 
    with the top-level directory as the working directory. RStudio users, 
    please open the .Rproj file in the top-level directory.
  - `input` contains one file and 1 or 3 directories.
    - The file `{SBS,indel}_syn_data_distribution.pdf` provides plots that  
      compare the distributions of mutation counts due to each signature in 
      real data and in the synthetic data
    - The 3 directories are:
      - Noiseless: (only in SBS_set1, indel_set1)
        Synthetic data with no negative binomial noise
      - Moderate: (only in SBS_set1, indel_set1)
        Synthetic data with moderate negative binomial noise
      - Realistic:
        Synthetic data with realistic negative binomial noise
    - Each directory contains the files:
      - ground.truth.syn.catalog.csv -- The synthetic tumor spectra
        in a format used by all programs other than SigProfilerExtractor
      - ground.truth.syn.catalog.tsv -- The synthetic tumor spectra
        in a format readable by SigProfilerExtractor
      - ground.truth.syn.exposures.csv -- The exposures of each synthetic tumor
        to each signature
      - ground.truth.syn.sigs.csv The ground truth signatures used to generate
        the synthetic data (identical for all SBS and for indel synthetic data sets)
      - {SBS,indel}\_syn_tumor_spectra\_{no,moderate,realistic}_noise.pdf Plots of the synthetic spectra

  - `raw_results` contains 4 directories, one for each tested program. Each directory contains: 
	- 3 Directories: `Noiseless` / `Moderate` / `Realistic`;
	  each of these directories contains 5 sub-directories called seed.Y, Y âˆˆ {145879, 200437, 310111, 528401, 1076753}
	  
	Each seed.Y directory contains:
	  - summary (summary of one run)
		- extracted.sigs.pdf: plots of extracted signatures
		- full.cossims.ex.to.gt.csv: Full cosine similarity matrix between ground-truth and extracted sigs.
		- match.ex.to.gt.csv: Match between extracted sigs and their
		  most similar ground-truth sigs (function
		  TP_FP_FN_avg_sim in package ICAMSxtra)   
	  - code.profile.Rdata or profiling_info.pickle: 
		CPU profiling info     
	  - extracted.signatures.csv          
	  - diagnostic_plots (only for mSigHdp): diagnostic plots        
	  - best.run (only for SignatureAnalyzer): results generated from the best run (basically
	    a run with the modal number of discovered signatures)  
 
 
 ### License
 
 Copyright (C) 2022 Steven G Rozen, Mo Liu, and Yang Wu

 Code and data in this repository are free software: you can redistribute them and/or modify
 them under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This code and data are distributed in the hope that they will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this code and data at 
 https://github.com/Rozen-Lab/Liu_et_al_Sup_Files/blob/main/gpl-3.0.txt.
 If not, see <http://www.gnu.org/licenses/>.
    
